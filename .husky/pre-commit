#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# ステージ済みファイルのみ整形/Lint（高速）
FILES=$(git diff --name-only --cached --diff-filter=ACM | grep -E '\.(ts|tsx|js|jsx|mjs|cjs)$' || true)
if [ -n "$FILES" ]; then
  bunx biome check --write --no-errors-on-unmatched $FILES || exit 1
  echo "$FILES" | xargs git add
fi

# 差分近傍の軽量Lint（重い処理は pre-push/CI 側で実施）
TURBO_FILTER="...[HEAD]" bun run lint || exit 1


